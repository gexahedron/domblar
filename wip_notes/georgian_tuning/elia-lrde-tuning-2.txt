мелодические сдвиги
0 {
    "0": 11,
    "14": 1,
    "17": 1,
    "21": 1,
    "22": 2,
    "23": 1,
    "24": 1,
    "25": 1,
    "27": 2,
    "28": 1,
    "32": 1,
    "33": 2,
    "41": 1,
    "47": 2,
    "50": 3,
    "53": 1,
    "58": 1,
    "61": 1,

    "109": 1,
    "111": 1,

    "144": 1,
    "149": 1,
    "158": 1,

    "182": 1,
    "185": 1,
    "188": 1,
    "200": 2,
    "204": 1,
    "210": 1,
    "212": 1,
    "213": 1,
    "216": 1,
    "219": 1,
    "221": 1,
    "231": 1,

    "254": 1,
    "268": 2,
    "281": 1,

    "328": 1,
    "344": 1
}
1 {
    "0": 4,

    "15": 1,

    "24": 1,
    "25": 1,
    "26": 2,
    "29": 1,
    "32": 1,
    "37": 1,
    "42": 1,
    "49": 1,
    "61": 1,
    "78": 1,

    "100": 1,
    "107": 1,
    "123": 1,
    "126": 1,
    "130": 1,
    "132": 1,
    "134": 1,
    "136": 1,
    "137": 3,
    "141": 1,
    "145": 1,
    "158": 2,
    "162": 1,
    "164": 1,
    "167": 1,
    "168": 2,
    "172": 1,

    "182": 1,
    "184": 1,
    "185": 1,
    "186": 1,
    "187": 1,
    "188": 1,
    "189": 1,
    "192": 1,
    "193": 1,
    "198": 1,
    "205": 1,
    "213": 1,

    "261": 1,
    "269": 1,
    "282": 1,
    "304": 1,
    "316": 1,
    "318": 1,
    "322": 1,
    "326": 1,
    "336": 1,
    "338": 1,
    "341": 1,
    "351": 1,

    "453": 1,
    "457": 1,
    "471": 1
}
2 {
    "0": 10,
    "10": 1,
    "12": 1,
    "13": 1,
    "14": 1,
    "16": 1,
    "17": 1,
    "26": 1,
    "27": 1,
    "29": 3,
    "30": 1,
    "32": 1,
    "34": 1,
    "38": 1,
    "48": 1,

    "100": 1,
    "112": 1,
    "114": 1,
    "116": 1,
    "120": 1,
    "125": 1,

    "139": 1,
    "147": 1,
    "154": 2,
    "157": 1,
    "160": 1,
    "163": 1,
    "164": 1,
    "165": 1,
    "170": 1,
    "176": 1,

    "189": 1,
    "192": 1,
    "207": 1,
    "217": 1,

    "343": 1,
    "344": 1,
    "349": 1,

    "403": 1,
    "414": 1,
    "433": 1,

    "479": 1,
    "480": 1,
    "507": 1,
    "510": 1,

    "666": 1,
    "682": 1,
    "694": 1
}


интервалы между голосами:
2-0:
тоника:
  -4 1  .
  6 1  .
  11 1 ?64/63 ji
  36 1 64/63 ?33/32 ji

576 1 ?45/32 7/5 ji

649 1 16/11 ji
656 1 16/11 ji
669 1 40/27 ji
670 1 40/27 ji
676 1 40/27 ji
679 1 40/27 ji
680 1 40/27 ji
682 1 40/27 ji
684 1 ?3/2 40/27 ji
688 1 ?3/2 40/27 ji
692 1 3/2 40/27 ji
701 1 3/2 ji
702 2 3/2 ji
704 1 3/2 ji
708 1 3/2 ji
709 1 3/2 ji
711 2 3/2 ?32/21 ji
712 1 3/2 ?32/21 ji
713 2 3/2 ?32/21 ji
715 1 ?3/2 ?32/21 ji
719 3 ?3/2 32/21 ji
723 1 32/21 ji
724 1 32/21 ji
726 1 32/21 ji
729 1 32/21 ji
731 1 32/21 ji
733 1 32/21 ji
734 1 32/21 ji
746 1 ?32/21 ji
751 1 ?14/9 ji
762 1 14/9 ji
766 2 14/9 ?11/7 ji
773 1 14/9 11/7 ji
778 1 ?128/81 ?14/9 11/7 ji

828 1 ?8/5 ji
836 1 ?18/11 ji
853 1 18/11 ji
865 1 18/11 ji

990 1 16/9 ji

1041 1 11/6 20/11 ji
1042 1 11/6 20/11 ji

1072 1 ?15/8 ji
1088 1 15/8 ji
1112 1 256/135 ji

1166 2 63/32 ji
тоже тоника:
  1192 1 2/1 ji
  1199 1 2/1 ji

2-1:
-124 1 16/15 ji
тоника:
  -8 1  .
  1 1  .
  2 1  .
  3 1  .
  4 1  .
  7 1  .

140 1 12/11 ji

167 1 ?10/9 ?12/11 11/10 ji
179 1 10/9 ?11/10 ji
180 1 10/9 ?11/10 ji
182 1 10/9 ?11/10 ji
183 1 10/9 ?11/10 ji
194 1 9/8 10/9 ji
196 1 9/8 ?10/9 ji
202 1 9/8 ji
206 1 9/8 ji
211 1 9/8 ji
214 1 9/8 ?8/7 ji
219 1 ?9/8 8/7 ji
222 1 ?9/8 8/7 ji
228 1 8/7 ji
232 1 8/7 ji
243 2 8/7 ji
246 1 ?8/7 ji
249 1 ?8/7 ?7/6 ji
252 1 ?7/6 ji
270 1 7/6 ji
289 1 32/27 ji
307 1 ?32/27 6/5 ji
308 2 ?32/27 6/5 ji
309 1 ?32/27 6/5 ji
311 1 ?32/27 6/5 ji
312 1 ?32/27 6/5 ji
314 1 6/5 ji
319 1 6/5 ji
320 1 6/5 ji
322 1 6/5 ji
323 1 6/5 ji
324 1 6/5 ji
326 2 6/5 ji
330 1 ?6/5 ?11/9 ji
333 1 ?6/5 ?11/9 ji
337 1 11/9 ji
348 2 11/9 ji
354 1 11/9 ji
375 1 5/4 ji
386 1 5/4 ji
392 1 ?81/64 5/4 ji
395 1 ?81/64 5/4 ji
397 1 81/64 5/4 ji
399 1 81/64 ?5/4 ?14/11 ji

431 1 9/7 ?14/11 ji
447 1 9/7 ji
450 1 ?9/7 ji

1-0:
тоника:
  -7 1  .
  4 1  .
  10 1 ?64/63 ji
  29 1 64/63 ji

325 1 6/5 ji
337 1 11/9 ji
347 1 11/9 ji
348 1 11/9 ji
361 1 ?11/9 ji
365 1 ?11/9 ji
381 1 5/4 ji
382 1 5/4 ji
384 1 5/4 ji
390 1 ?81/64 5/4 ji
408 1 81/64 14/11 ji
409 1 81/64 14/11 ji
412 1 81/64 14/11 ji
414 1 81/64 14/11 ji
415 1 81/64 14/11 ji
421 1 ?81/64 ?9/7 14/11 ji
431 1 9/7 ?14/11 ji
432 1 9/7 ?14/11 ji
436 1 9/7 ?14/11 ji
454 1 ?21/16 ji
456 1 ?21/16 ji
465 1 21/16 ji
479 1 21/16 ji
488 1 4/3 ?21/16 ji
490 1 4/3 ji
496 1 4/3 ji
500 1 4/3 ji
501 2 4/3 ?27/20 ji
502 1 4/3 ?27/20 ji
505 1 4/3 ?27/20 ji
512 1 ?4/3 27/20 ji
516 1 ?4/3 27/20 ji
517 1 27/20 ji
522 1 27/20 ji
523 1 27/20 ji
530 1 27/20 ji
531 1 27/20 ji
532 1 27/20 ji
538 1 ?27/20 ?11/8 ji
558 1 11/8 ji
562 1 11/8 ji
593 1 45/32 ?64/45 7/5 ji
595 1 45/32 ?64/45 7/5 ji

677 2 40/27 ji
696 1 3/2 ?40/27 ji
700 1 3/2 ji
704 1 3/2 ji
713 1 3/2 ?32/21 ji
734 1 32/21 ji

840 2 ?18/11 ji
859 1 18/11 ji
877 1 5/3 ji



0 = 2060
точно существуют, как стабильные ноты:
0, 154, 172, 344, 490, 667-687
точно существуют хотя бы как относительные:
820
начало мелодии:
  667-490-340-170
  разницы - ~174-154-174
сошёлся на
  a = 152, b = 170
  0, 152, 170, 340=2*b, 492=2*b+a, 662=3*b+a
  также есть:
  -40 = 662 - 702 = 3*b+a - 3/2
  435 = 9/7 (можно ещё попробовать вычислить как 2*b+a+100); 662-435=227 = 8/7
  702 = 3/2
  -210 = 492 - 3/2
  -362 = 2*b - 3/2 = 340 - 3/2
  -544 = -362 - a = 2*b-a - 3/2
  602 = 3/2 - 100

-362 -210 -40  0  152  170  340  435  492  602  662  702

[-544 -445 -270
  204  270  310  560  820] #687?

le [-370, 0, 340] orig: [-400, 10, 347]
le [('710c 3/2', 'ji'), ('340c 11/9', 'ji'), ('370c 5/4', 'ji')]
  melstep [173, -340, None]
    le [('746c 32/21', 'ji'), ('337c 11/9', 'ji'), ('409c 81/64 14/11', 'ji')]
      melstep [144, -351, None]
si [-218, 340, 492] orig: [-200, 332, 513]
si [('709c 3/2', 'ji'), ('152c 12/11 11/10', 'ji'), ('557c 11/8', 'ji')]
  melstep [153, 340, 152]
    si [('711c 3/2 32/21', 'ji'), ('180c 10/9 11/10', 'ji'), ('531c 27/20', 'ji')]
      melstep [200, 322, 165]
  ох
  был шаг в 200, стал в 152, сложно
  видимо ошибся где-то
  я бы наверно хотел бы сохранить шаг в 200 центов

a/ma/ua [0, 340, 710] orig: [-7, 341, 727]
a/ma/ua [('710c 3/2', 'ji'), ('370c 5/4', 'ji'), ('340c 11/9', 'ji')]
  melstep [47, -152, 0]
    a/ma/ua [('734c 32/21', 'ji'), ('386c 5/4', 'ji'), ('348c 11/9', 'ji')]
      melstep [41, -134, 9]
a [-218, 170, 603] orig: [-238, 178, 627]
a [('819c 8/5', 'ji'), ('433c 9/7 14/11', 'ji'), ('386c 5/4', 'ji')]
  melstep [-217, -171, -108]
    a [('865c 18/11', 'ji'), ('450c 9/7', 'ji'), ('415c 81/64 14/11', 'ji')]
      melstep [-231, -164, -100]
ki [-370, 492, 820] orig: [-347, 493, 819]
ki [('1190c 2/1 63/32', 'ji'), ('328c 6/5', 'ji'), ('862c 18/11', 'ji')]
  melstep [-153, 323, 218]
    ki [('1166c 63/32', 'ji'), ('326c 6/5', 'ji'), ('840c 18/11', 'ji')]
      melstep [-109, 316, 192]

   [0, 340, 710] orig:   [-7, 341, 727]
   я тут понял, что возможно 710 (fifth) - это ошибка
   вероятно тут теоретически 734 цента должно быть
[-218, 170, 603] orig: [-238, 178, 627]
[-370, 492, 820] orig: [-347, 493, 819]
-218 = 2*b+a - fifth
-370 = 2*b - fifth
ага, явно проблема - я растянул шаго в 110 центов до шага в 150
это неправильно

не могу никак восстановить что было в tmp.txt:
a/ma/ua [0, 330, 708] orig: [-7, 341, 727]
a/ma/ua [('707c 3/2', 'ji'), ('377c 5/4', 'ji'), ('330c 6/5 11/9', 'ji')]
  6:5:4
  melstep [50, -149, 0]
    a/ma/ua [('734c 32/21', 'ji'), ('386c 5/4', 'ji'), ('348c 11/9', 'ji')]
      melstep [41, -134, 9]
      5/4 и 11/9 точные до цента
можно предположить, что гипотетически в верхнем голосе сейчас
  734 цента = 5/4 + 11/9
a [-215, 180, 657] orig: [-238, 178, 627]
? a [('871c 5/3 18/11', 'ji'), ('477c 21/16', 'ji'), ('394c 81/64 5/4', 'ji')]
  ? melstep [-214, -150, -50]
    a [('865c 18/11', 'ji'), ('450c 9/7', 'ji'), ('415c 81/64 14/11', 'ji')]
      melstep [-231, -164, -100]
      а значит здесь в верхнем голосе по идее примерно 634 цента
      231, кстати, это 8/7
      165 ~= 11/10, но мб это шаг в ~170 центов
  в tmp.txt вот так:
  a [('872c 5/3', 'ji'), ('433c 9/7 14/11', 'ji'), ('439c 9/7', 'ji')]
    прикольно, 9/7 * 9/7
    a [('865c 18/11', 'ji'), ('450c 9/7', 'ji'), ('415c 81/64 14/11', 'ji')]
      а тут другой аккорд
      18:14:11
  можно попробовать вычислить низ как:
    ((5/4 + 11/9) - 100) - (9/7 + 9/7)
    получится -236
ki [-390, 480, 810] orig: [-347, 493, 819]
ki [('1200c 2/1', 'ji'), ('331c 6/5 11/9', 'ji'), ('869c 5/3 18/11', 'ji')]
  6:5:3 (думаю, что должно быть точно)
  melstep [-176, 299, 153]
    ki [('1166c 63/32', 'ji'), ('326c 6/5', 'ji'), ('840c 18/11', 'ji')]
      melstep [-109, 316, 192]
  тогда здесь нижний голос по идее:
    ((5/4 + 11/9) - 100) - (9/7 + 9/7) - 100 = -336
  а верхний примерно:
    634+200 = 834
    ну кстати, 1170 центов, не 1200
  сложно!




le/me [-40, 435, 662]
le/me [('702c 3/2', 'ji'), ('228c 8/7', 'ji'), ('474c 21/16', 'ji')]
    le/me [('702c 3/2', 'ji'), ('246c 8/7', 'ji'), ('456c 21/16', 'ji')]
i [0, 435, 687]
i [('686c 3/2 40/27', 'ji'), ('252c 7/6', 'ji'), ('434c 9/7 14/11', 'ji')]
    i [('670c 40/27', 'ji'), ('249c 8/7 7/6', 'ji'), ('421c 81/64 9/7 14/11', 'ji')]
    16:14:11? непонятно
    мы подбирали 435 как 9/7, а теперь оно тут как 14/11
    может тогда взять как геометрическое среднее? 426 центов
    может тогда 9:7:6? да, давай так, правда
    может тогда 687 убрать? но это прям на 30 центов сдвигаю
    i [0, 435, 702] orig: [26, 447, 697]
    i [('702c 3/2', 'ji'), ('268c 7/6', 'ji'), ('434c 9/7 14/11', 'ji')]
    вот так тогда
a [-40, 435, 662] orig: [-21, 415, 667]
a [('702c 3/2', 'ji'), ('228c 8/7', 'ji'), ('474c 21/16', 'ji')]
    a [('688c 3/2 40/27', 'ji'), ('252c 7/6', 'ji'), ('436c 9/7 14/11', 'ji')]
  здесь явно поменялась гармония
  было 3/2 ~= 7/6 * 9/7 (хотя и грубо, 15 центов)
  стало 3/2 = 8/7 * 21/16 (точно)
  я на слух не слышу разницы
uo [-270, 270, 560] orig: [-275, 283, 553]
uo [('829c 8/5', 'ji'), ('289c 32/27', 'ji'), ('540c 11/8', 'ji')]
    uo [('828c 8/5', 'ji'), ('270c 7/6', 'ji'), ('558c 11/8', 'ji')]
  тут всё новые ноты, не знаю пока что
o [-544, 340] orig: [-544, 362]
o [('883c 5/3', 'ji')]
    o [('904c 27/16', 'ji')]
    было 9 полутонов, стало ровно 5/3, не знаю пока что
    может надо 544 ниже сделать
le [-380, 0, 340] orig: [-400, 10, 347]
le [('720c 3/2 32/21', 'ji'), ('340c 11/9', 'ji'), ('380c 5/4', 'ji')]
    le [('746c 32/21', 'ji'), ('337c 11/9', 'ji'), ('409c 81/64 14/11', 'ji')]
    сложный вопрос, 746 - это совсем не 3/2, а что-то четвертитоновое скорее

si [-204, 340, 492] orig: [-200, 332, 513]
si [('696c 3/2 40/27', 'ji'), ('152c 12/11 11/10', 'ji'), ('544c 11/8', 'ji')]
    si [('711c 3/2 32/21', 'ji'), ('180c 10/9 11/10', 'ji'), ('531c 27/20', 'ji')]
  допустим тут 12:11:8
    хотя этого нет в пении, так что пока отложу

a [-204, 204, 560] orig: [-223, 210, 540]
a [('763c 14/9', 'ji'), ('355c 11/9', 'ji'), ('408c 81/64 14/11', 'ji')]
    a [('762c 14/9', 'ji'), ('330c 6/5 11/9', 'ji'), ('432c 9/7 14/11', 'ji')]
    14:11:9 (очень точно, 5 центов)
  тут всё новые ноты, не знаю пока что

надо дальше копать!

i [0, 492, 702] orig: [2, 504, 715]
i [('702c 3/2', 'ji'), ('210c 9/8', 'ji'), ('492c 4/3', 'ji')]
    i [('713c 3/2 32/21', 'ji'), ('211c 9/8', 'ji'), ('502c 4/3 27/20', 'ji')]
  прикольно, 492 ~= 498 = 4/3, не заметил
  9/8 = 204
  9:8:6
a [-204, 170, 492] orig: [-218, 165, 487]
a [('696c 3/2 40/27', 'ji'), ('323c 6/5', 'ji'), ('373c 5/4', 'ji')]
    a [('704c 3/2', 'ji'), ('323c 6/5', 'ji'), ('381c 5/4', 'ji')]
  492-170=322 ~= 315.6 = 6/5
    492=2*b+a => a+b ~= 6/5
  -210 = 492 - 702

после введения -210 словил проблемы:
  a [-210  170  603] [-238  178  627] [ 28  -8 -24]
  !!!DIFF: 52
  si/li [-210  340  492] [-176  340  481] [-34   0  11]
  !!!DIFF: 45
  может надо 702 поправить на 710, скажем, посмотрим

uo [-362, 340, 340] orig: [-377, 328, 332]
uo [('701c 3/2', 'ji'), ('0c', '.'), ('701c 3/2', 'ji')]
    uo [('708c 3/2', 'ji'), ('4c', '.'), ('704c 3/2', 'ji')]
  -362 = 340 - 3/2


a/da/ma [0, 492, 702] orig: [-17, 481, 687]
a/da/ma [('702c 3/2', 'ji'), ('210c 9/8', 'ji'), ('492c 4/3', 'ji')]
    a/da/ma [('702c 3/2', 'ji'), ('206c 9/8', 'ji'), ('496c 4/3', 'ji')]
  тут ок
ki [-362, 492, 820] orig: [-380, 497, 819]
ki [('1181c 63/32', 'ji'), ('328c 6/5', 'ji'), ('853c 18/11', 'ji')]
    ki [('1199c 2/1', 'ji'), ('322c 6/5', 'ji'), ('877c 5/3', 'ji')]
  надо поправить 820, получится 838
  но аккорд уже явно не будет как 6:5:3
  надо подумать ещё

retuned_cents [-370, -218, -48, 0, 152, 170, 340, 435, 492, 662, 710,
-544, -445, -270, 204, 270, 310, 560, 603, 820]



0 = 2070
точно существуют, как стабильные ноты:
0, ~330, 480, 657-677
точно существуют хотя бы как относительные:
810
    [-554 -455 -390 -280 -215  -50    0  144  160  180  200  260  300  330  420  480  550  593  657  677  708  810]
                                                                                             e [657]
                                                                            lya [480]
                                                                  lar [330]
                                          de [160]
                                                                              i [480]
                                                                   la [330]
                           la [-50,                                    330,                     657]
                                i/qi [0,                                    420,                657]
                                                                                             i [657]
                        le/me [-50,                                         420,                657]
                                   i [0,                                    420,                     677?]
                            a [-50,                                         420,                657]
                uo [-280,                                    260,                     550]
  o [-554,                                                             330]
           le [-390,                  0,                               330]
                     si [-215,                                         330,      480]
                      a [-215,                          200,                          550]
                                  uo [0]
    [-554 -455 -390 -280 -215  -50    0  144  160  180  200  260  300  330  420  480  550  593  657  677  708  810]
                              a/sa+i [0,                                         480,                     708]
                                 i/a [0,                                                                  708]
                         a/da [-50,                                              480,                     708]
                             a/ma/ua [0,                               330,                               708]
                 a [-280,                     160,                                         593]
        ki+ri [-390,                                                             480,                          810]
          o/a [-390,                                              300,                                    708]
    uo/a [-455?,                         144,                                              593]
                                    o/a [144,                260]
           le [-390,                  0,                          300]
                  si/ri [-215,                                    300,                          657]
                      a [-215,                160,                               480]
                                  uo [0]
    [-554 -455 -390 -280 -215  -50    0  144  160  180  200  260  300  330  420  480  550  593  657  677  708  810]
                          kra [-50,                                         420,                     677?]
                           si [-50,                                              480,                     708]
           uo [-390,                                              300,                               677?]
         uo/o [-390,                                              300]
                  de/re [-215,           144,                                    480]
                          kra [-50,                                              480,                677?]
                           si [-50,                                              480,                677?]
           uo [-390,                                                   330]
             de/le [-280,                     160,                               480]
                            a [-50,                                         420,                657]
                         li/i [-50,                                              480,                677?]
                        a/gha [-50,                              300,                           657]
                         li/i [-50,                                              480,                     708]
                        me/ma [-50,                                              480,                677?]
                                   i [0,                                         480,                677?]
                                   a [0,                               330,                     657]
                uo [-280,                          180,                          480]
 uo [-554,                                         180,                          480]
        lo/le [-390,                  0,                               330]
                  si/li [-215,                                         330,      480]
                      a [-215,                          200,                     480]
                                  uo [0]
    [-554 -455 -390 -280 -215  -50    0  144  160  180  200  260  300  330  420  480  550  593  657  677  708  810]
                               so/sa [0,                                         480,                677?]
                                  li [0,                                         480,                677?]
                      a/da/ma [-50,                                              480,                677?]
                               ma/ua [0,                               330,                               708]
                      a [-215,                160,                                         593]
           ki [-390,                                                             480,                          810]
           ri [-390,                                                             480,                          810]
            a [-390,                                              300,                               677?]
  uo/lol [-455?,                              160,                                    550]
  le/lol [-455?,                         144,                260]
        le/me [-390,                  0,                          300]
                  si/li [-215,                                         330,                     657]
                      a [-215,                          200,                     480]
                                  uo [0]
    [-554 -455 -390 -280 -215  -50    0  144  160  180  200  260  300  330  420  480  550  593  657  677  708  810]
